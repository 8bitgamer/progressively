!function(a,b){"function"==typeof define&&define.amd?define(function(){return b(a)}):"object"==typeof exports?module.exports=b:a.progressively=b(a)}(this,function(a){"use strict";function h(a,b){var c={};for(var d in a)c[d]=b.hasOwnProperty(d)?b[d]:a[d];return c}function i(a){return null===a.offsetParent}function j(a){if(i(a))return!1;var b=a.getBoundingClientRect(),c=b.top,d=b.height;a=a.parentNode;do{if(b=a.getBoundingClientRect(),c<=b.bottom==!1)return!1;if(c+d<=b.top)return!1;a=a.parentNode}while(a!==document.body);return c<=document.documentElement.clientHeight}function k(a,b){setTimeout(function(){var c=new Image;return c.onload=function(){a.classList.remove("progressive--not-loaded"),a.classList.add("progressive--is-loaded"),a.src=this.src,e(a)},l()<b.smBreakpoint&&a.getAttribute("data-progressive-sm")?(a.classList.add("progressive--loaded-sm"),c.src=a.getAttribute("data-progressive-sm"),!1):(a.classList.remove("progressive--loaded-sm"),c.src=a.getAttribute("data-progressive"),!0)},b.delay)}function l(){return Math.max(document.documentElement.clientWidth,window.innerWidth||0)}function m(){d||(clearTimeout(d),d=setTimeout(function(){b.check(),b.render(),d=null},c.throttle))}var c,d,e,f,g,b={};return e=function(){},c={throttle:300,delay:100,onLoadComplete:function(){},onLoad:function(){},smBreakpoint:600},b.init=function(d){d=d||{},c=h(c,d),e=c.onLoad||e,f=[].slice.call(document.querySelectorAll(".progressive__img")),g=[],b.render(),document.addEventListener?(a.addEventListener("scroll",m,!1),a.addEventListener("resize",m,!1),a.addEventListener("load",m,!1)):(a.attachEvent("onscroll",m),a.attachEvent("onresize",m),a.attachEvent("onload",m))},b.render=function(){for(var a,b=f.length-1;b>=0;--b)a=f[b],j(a)&&(a.classList.contains("progressive--not-loaded")||a.classList.contains("progressive--loaded-sm"))&&(k(a,c)||g.push(a),f.splice(b,1));if(l()>=c.smBreakpoint)for(var d=g.length-1;d>=0;--d)a=g[d],j(a)&&(a.classList.contains("progressive--not-loaded")||a.classList.contains("progressive--loaded-sm"))&&(k(a,c),g.splice(b,1));this.check()},b.check=function(){f.length||g.length||(c.onLoadComplete(),this.drop())},b.drop=function(){document.removeEventListener?(a.removeEventListener("scroll",m),a.removeEventListener("resize",m)):(a.detachEvent("onscroll",m),a.detachEvent("onresize",m)),clearTimeout(d)},b});